# -*- coding: utf-8 -*-
"""image classification new code

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Tb3tMWy9lDToUbMi3-6BXUedes7ZrJ43

download the datasets
"""

! wget https://drive.google.com/drive/my-driv

!unzip/content/drive/MyDrive/catvs dog/PetImages/Dog/100.jpg

import numpy as np 
import pandas as pd
from PIL import Image  
import matplotlib.pyplot as plt
import cv2

import os
for dirname, _, filenames in os.walk('/kaggle/input'):
    for filename in filenames:
        pass

Path ="/content/drive/MyDrive/catvs dog"

catvsdogs ={}

for dirname, dirlist, filenames in os.walk(Path):
 catvsdog_name = dirname.split('/')[1]
 if dirname != Path:
        print("Number of {catvsdog} images: {len(filenames)}")
        filePaths = []
        for filename in filenames:
            filePaths.append(os.path.join(Path, dirname, filename))
        catvsdogs[catvsdog_name] = filePaths

fig, ax = plt.subplots(1,4, figsize=(20, 11))
img1 = cv2.imread(Path)
img1 = cv2.cvtColor


img2 = cv2.imread(Path)
img2 = cv2.cvtColor


img3 = cv2.imread(Path)
img3 = cv2.cvtColor


plt.show()

from os.path import join
input_path = []
label = []

X = []
y = []
convert = lambda category : int(category == 'dog')

def create_test_data(path):
    for p in os.listdir(path):
      category = p.split(".")[0]
      category = convert(category)
      img_array = cv2.imread(os.path.join(path,p),cv2.IMREAD_GRAYSCALE)
      new_img_array = cv2.resize(img_array, dsize=(80, 80))
      X.append(new_img_array)
      y.append(category)

len(label)

len(input_path)

def create_test_data(path):
 X = np.array(X).reshape(-1, 80,80,1)
 y = np.array(y)

X = 255.0

model = 1

sequential:any